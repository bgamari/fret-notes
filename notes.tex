\documentclass{article}
\usepackage{amsmath}
\usepackage[color=blue!20,colorinlistoftodos]{todonotes}
\newcommand{\refneeded}{\todo[color=green!20]{Referenced needed.}}

\title{Some notes on single-molecule FRET}
\author{Ben Gamari}

\newcommand{\emm}[1]{\ensuremath{_{#1_\mathrm{em}}}}
\newcommand{\exc}[1]{\ensuremath{^{#1_\mathrm{exc}}}}
% \i{em}{exc}
\newcommand{\I}[2]{\ensuremath{I\emm{#1}\exc{#2}}}
    
\begin{document}
\maketitle

F\"orster Resonance Energy Transfer (FRET) is an energy transfer
process due to the electromagnetic coupling between dipoles. Under
this interaction, an excited fluorophore (the donor) can transfer energy
to a nearby molecule (the acceptor) with given an appreciable mutual
spectral overlap. FRET is often used in the study of single-molecule
systems, where it enables the determination of reaction kinetics,
binding constants, and some classes of conformational dynamics.
By exciting the donor while observing photon emissions from both the
donor and accessor, the experimentalist can assess the efficiency of
the FRET coupling. Informed by further physical models, FRET
experiments can be interpretted to make strong, physically-relevant
inferences.

We define the FRET efficiency $E$ to be the quantum yield of this
energy transfer process. As such, we can write it as a function of the
system's transition rates,
\begin{equation}
  E = \frac{k_{ET}}{k_{ET} + \sum_i k_{R_i} + \sum_i k_{NR_i}}
  \label{Eq:fretRates}
\end{equation}
where,

\begin{tabular}{lcl}
  $k_{ET}$  & = & rate of donor to acceptor energy transfer \\
  $k_{D-R}$   & = & rate of donor fluorescence radiative decay \\
  $k_{D-NR}$  & = & rate of donor non-radiative decay \\
\end{tabular}

We define $k_{DA}$ to be the effective rate of donor relaxation in the presence
of the acceptor,
\[ k_{DA}^{-1} = k_{ET}^{-1} + \sum_i k_{D-R_i}^{-1} + \sum_i k_{D-NR_i}^{-1} \]
Eliminating $k_{ET}$ from \eqref{Eq:fretRates} gives the alternative expression,
\begin{equation}
  E = 1 - \frac{k_{DA}}{k_{D-R}} \label{Eq:fretEffRates}
\end{equation}
By relating the fluorescence lifetimes to the rates, $\tau = k^{-1}$,
we find a similar result in terms of this relevant physical parameter,
\begin{equation}
  E = 1 - \frac{\tau_{D}}{\tau_{DA}} \label{Eq:fretEffTau}
\end{equation}

Equivalently, we can give the FRET efficiency in terms of equilibrium
parameters of the system,
\begin{equation}
  E = \frac{1}{1 + \left( \frac{r}{R_0} \right)^6}
  \label{Eq:fretEff}
\end{equation}
where $R_0$ is the F\"orster radius,
\begin{equation}
  R_0^6 = \frac{9 c^4 Q_0 \kappa^2 J}{128 \pi^5 N_A n^4}
  \label{Eq:R0}
\end{equation}
where $N_A$ is Avogadro's number, $Q_0$ is the quantum yield of the
donor in the absence of the acceptor, and $n$ is the index of
refraction of the solvent.

$J$ denotes the spectral overlap integral,
\[ J = \int f_D(\lambda) \epsilon_A(\lambda) \lambda^4 d\lambda \]
where $f_D$ is the normalized donor emission spectrum and $\epsilon_A$
is the acceptor's molar extinction coefficient.

An important but oft-overlooked ``constant'' of \eqref{Eq:R0} is
the so-called dipole orientation factor, $\kappa^2$,
\begin{equation}
  \kappa = \hat\mu_D \cdot \hat\mu_A - 3(\hat\mu_D \cdot \hat R_{DA}) (\hat\mu_A \cdot \hat R_{DA})
  \label{Eq:kappa}
\end{equation}

While measurement of the FRET efficiency is possible by way of the
fluorescence lifetime and \eqref{Eq:fretEffTau}, a more common
approach is by way of an intensity measurement. Here, one 
measures $k_{R}$ and $k_{ET}$ by observing fluorescence intensities
from the donor and acceptor fluorophores, $k^*_D$ and $k^*_A$. This
measurement, however, is fraught with artifacts.

Let us examine the processes responsible for the observed rates
$k^*_D$ and $k^*_A$ for the acceptor and donor respectively. Assume
that the fluorescence of interest originates from donor decay channel
$D-R_j$ and acceptor channel $A-R_k$. We first note that not every
excitation event will result in an emission photon due to the
non-radiative decay pathways $NR_i$. We call the efficiency of photon
product the quantum yield $\phi$,
\begin{align*}
  \phi_D & = \frac{k_{D-R_j}}{\sum k_{D-R_i} + \sum k_{D-NR_i}} \\
  \phi_A & = \frac{k_{A-R_k}}{\sum k_{A-R_i} + \sum k_{A-NR_i}} \\
\end{align*}
\todo{Discuss relationship between quantum yield and lifetime}

Furthermore, any real measurement will have less than perfect, and
often wavelength dependent, detection efficiency, $\eta < 1$.  Under
these considerations, we assuming a donor excitation rate $k_{exc}$ to
find fluorescence rates $k^*_D$ and $k^*_A$,
\begin{align*}
  k^*_D & = k_{exc} ~ \eta_D ~ \frac{k_{D-R_j}}{k_{ET} + \sum k_{D-R_i} + \sum k_{D-NR_i}} \\
        & = k_{exc} ~ \eta_D ~ \phi_D ~
           \frac{\sum k_{D-R_i} + \sum k_{D-NR_i}}{k_{ET} + \sum k_{D-R_i} + \sum k_{D-NR_i}} \\
        & = k_{exc} ~ \eta_D ~ \phi_D ~ (1 - E) \\
  k^*_A & = k_{exc} ~ \eta_A ~ \phi_A ~ E \\
\end{align*}

From these rates, we can construct an observed FRET efficiency (also
known as the proximity ratio), $E^*$,
\begin{align*}
  E^* & = \frac{k^*_A}{k^*_A + k^*_D} \\
      & = \left[ 1 + \left(\frac{\phi_A~\eta_A}{\phi_D~\eta_D}\right)^{-1} (E^{-1} - 1) \right]^{-1} \\ \label{Eq:proxRatio}
\end{align*}
We denote the quantity $(\phi_A~\eta_A / \phi_D~\eta_D)$ as $\gamma$,
which represents the relative sensitivity of our experiment to the two
fluorophores. While the constituents of $\gamma$ are usually
prohibitively difficult to determine, correction for $\gamma$ as a
whole is quite easy given proper experimental design. From
\eqref{Eq:proxRatio}, we can derive the corrected FRET efficiency $E$,
\begin{equation}
  E = \frac{k^*_A}{k^*_A + \gamma k^*_D}
  \label{Eq:gammaFretEff}
\end{equation}
In addition to $\gamma$ correction, there are two further corrections that
must be routinely made during FRET data analysis. The first of these
is spectral crosstalk between the acceptor and donor channels. This
artifact is largely due to the imperfect spectral filtering of
dichroic mirrors, resulting in leakage of donor photons into the
acceptor channel. Moreover, all experiments must deal with a constant
background on top of the measured signal. Accounting for these two effects
yields an estimate for the true observed intensity,
\begin{align*}
  I_D & = k^*_D - \alpha~k^*_D + I_{D-BG} \\
  I_A & = k^*_A + \alpha~k^*_D + I_{A-BG} \\
\end{align*} 
where $I_{BG}$ are the background count rates and $\alpha$ is the crosstalk
parameter. Propagating these through our estimator for the FRET
efficiency, we find the background, cross-talk, and $\gamma$ corrected
FRET efficiency to be,
\[
  \hat E = \frac{E^* ~ \left(1 + \gamma ~ (\beta_A + \beta_D)\right) - \gamma~\beta_A - \alpha}
    {E^* ~ (1 - \gamma) + \gamma - \alpha}
\]
where,
\begin{align*}
  \beta_A & = \frac{I_A}{k_{exc}~\eta_A~\phi_A} \\
  \beta_D & = \frac{I_D}{k_{exc}~\eta_A~\phi_A} \\
\end{align*}
Clearly, the dependence on $k_{exc}~\eta_A~\phi_A$ poses a difficulty
as these are all unobserved quantities. One way to approach this would
be to ?.

\section{Determination of $\gamma$}
While we can now properly correct for $\gamma$ by way of
\eqref{Eq:gammaFretEff}, this tool is useless unless we can determine
the value of $\gamma$. The most obvious approach here is to examine a
population with a known FRET efficiency to derive $\gamma$, which one
can then use for correction. For this reason, the meticulous
experimentalist will always take data on sample lacking acceptor
fluorophores. As $\gamma$ depends upon instrumental state
(e.g. alignment, detector response), it is important to run these
calibration experiments often. Moreover, since the quantum yield of a
fluorophore depends strongly on its environment, it is wise to use the
specimen under study for these calibrations, with the acceptor
fluorophore either desensitized or not present, of course.

Lacking a dedicated donor-only experiment, one can often also
exploit the donor-only population usually present after sample
preparation as the calibration sample.

While relying on the donor-only population makes for a convenient
means of approximating $\gamma$, the approach is severely limited in
the presence of a low-FRET population. States low FRET efficiency are
clearly indistinguishable from donor-only specimens. This effect can
severely bias the resulting estimate of $\gamma$. Given that the FRET
efficiency histogram is usually largely unknown prior to experiment,
assuming the non-existence of such a low-FRET state is out of the
question. For this reason, we require a more powerful tool to resolve
these states.

\section{Alternating Laser Excitation}
While FRET alone *, the information content in an experiment can be
greatly enhanced through use of Alternating Laser Excitation (ALEX) as
proposed by Kapanidis, {\it et al.}\cite{Kapanidis2005}. One of the
great difficulties in the interpretation of FRET results is the
difficulty of resolving low FRET efficiencies. Due to considerations
of sample preparation, photobleaching, and *, a substantial fraction
of the molecules measured in a typical FRET experiment will have no
acceptor fluorophore.

While distinguishing this population from a low-FRET state is nearly
impossible under traditional FRET, ALEX uses direct excitation of the
acceptor to probe its existence. This alternation is carried out at a
timescale far shorter than the specimens' diffusion time, giving
access to an additional axis of the typical FRET efficiency histogram.

In the following discussion, we adopt a notation similar to that of
Kapanidis, {\it et al}. Let \I{A}{D} denote the intensity of emission
into the acceptor channel under donor excitation. Under this notation,
we define our existing notation $I_A$ and $I_D$ as,
\begin{align*}
  I_A & = \I{A}{A} + \I{A}{D} \\
  I_D & = \I{D}{A} + \I{D}{D} \\
\end{align*}
Therefore, our familiar FRET efficiency is given by,
\[ E = \frac{\I{A}{D}}{\I{A}{D} + \gamma \I{D}{D}} \]
Moreover, we can now define a quantity which we call the
stoichiometry, $S$, which characterizes the ratio of acceptor
fluorophores to donor fluorophores,
\[ S = \frac{I\exc{D}}{I\exc{D} + I\exc{A}} \]

While ALEX allows us to separate previously unseparable populations,
it is no less susceptible to cross-talk, background, and $\gamma$
errors. Correcting $S$ in the same manner as we did $E$ earlier, we
find that ?.

\todo{Finish ALEX discussion}

\subsection{Fluorophore photophysics}
We would hope that our fluorophores had no physics of their own,
instead only reflecting the physics of the system of interest. Sadly,
it is unlikely that a molecule with this property will ever be
discovered. In reality, fluorophores are their own chemical species
with their own mechanics, chemical interactions, and physics. 

Ultimately, any experiment studying a single-molecule is going to be
limited by the amount of information one is able to extract from the
specimen before it ``dies''. In the case of a fluorscence experiment,
this death generally comes by way of bleach of fluorophores. The
mechanisms behind what is generally referred to as ``photobleaching''
are varied and fluorophore dependent. These include,
\begin{itemize}
\item Dark photo-induced isomeric states
\item Oxidative damage by singlet oxygen
\item Denaturation via multiple photon excitation\cite{Deschenes2002}
\end{itemize}
It should be noted that some of these ``bleaching'' mechanisms
(e.g. isomization) are in fact reversible. This allows species to be
recovered for study and can be exploited to stochastically sensitize
or desensitize florophores.

Of course, the useful lifetime of the molecule must be compared to the
rate at which information can be extracted, namely the photon count
rate of the experiment. While this rate is ultimately limited by the
fluorescence lifetime, it is further limited by triplet state transitions
present in most fluorophores. These triplet states are accessed by
forbidden transitions through
interaction with the environment and support effectively no
fluoroscence. Due to their forbidden nature , these states are
generally long-lived. Triplet transitions (also known as inter-system
crossings) given rise to blinking of fluorescence.

The experimentalist has a variety of tools at his disposal for managing
these parasitic photophysical processes. Photo-induced isomerization
can usually be reversed by excitation on fluorophore specific
wavelengths\cite{Fan2011}. Oxidative photobleaching can be suppressed
by elimination of oxygen in the system. This can be achieved by use of
an oxygen scavenging system, such as Puglisi's PCA/PCD
enzyme/substrate pair\cite{Aitkin2008} or Glucose Oxidase and Catalase
(GODCAT)\refneeded.

Triplet state lifetime can be reduced by use of a chemical system of
reducing and oxidizing agents\cite{Vogelsang2008}. Here, a reducing
agent serves to quench the triplet state, resulting an a radical
anion. This anion is then reoxidized by an oxidizing agent before it
is able to bleach the fluorophore. Common realizations of this system
include\cite{Dave2009},
\begin{itemize}
\item Trolox\cite{Rasnik2006}
\item $\beta$-mercaptoethanol (BME)
\item mercaptoethylamine (MEA)
\item $n$-propyl gallate
\item 1,4-diazabicyclo[2.2.2]octane (DABCO)
\item Cyclooctatetaene (COT)
\end{itemize}

Of course, use of these tools demands care. The elimination of oxygen
from the system will enhance triplet transitions (as interaction
molecular oxygen is one of the most effective ways to escape a triplet
well\cite{Campos2011}). Moreover, at least one notable ROXS system
(Trolox) requires oxygen to function (as photo-induced oxidation of
Trolox gives rise to the system's reducing agent\cite{Cordes2009}).

Finally, one must always keep in mind that any chemical species
introduced to the sample environment may interact with the studied
system or its fluorophores.

\subsection{Photon statistics}
Equipped with the above tools, we are now able to construct a
reasonable FRET efficiency histogram given data from a well-considered
experiment. While it is often possible to derive a great deal of
understanding from a mere qualitative examination of this histogram,
if we are to maximize the information extracted from our experiment,
we will need tools of a more quantitative nature.

We will begin by examining the statistics of photons resulting from a
hypothetical single-molecule experiment. Recall that under first-order
kinetics, the evolution of the system satisfies,
\[ \frac{d}{dt} \mathbf{G}(t) = \mathbf{K} \mathbf{G}(t) \]
where $\mathbf{K}$ is the transition matrix, where element $k_{ij}$ is
the rate of transition from state $j \rightarrow i$. We note that we
can solve this equation by a Green function expansion with the
operator $\mathbf{L} = \frac{d}{dt} - \mathbf{K}$. Recall that the
Green function plays the role of the propagator: $G_{ji}(T)$ is the
probability that a system in state $i$ at $t=0$ will evolve to state
$j$ at time $T$.

As a matter of practicality, our work will be much simpler in the
Laplace domain. Recall that this entails,
\begin{align*}
f(t) & \rightarrow \hat f(s) \\
\frac{d}{dt} f(t) & \rightarrow (s~ \hat f(s) - f(0)) \\
\end{align*}
Therefore, we have,
\[ s~\mathbf{\hat G}(s) - \mathbf{G}(0) = \mathbf{K} \mathbf{\hat G}(s) \]
or, after rearranging,
\[ \mathbf{\hat G}(s) = (s \mathbf{1} - \mathbf{K})^{-1} \]

With this result in hand, we set out to answer a more challenging
question: given a system in state $\alpha$ at $t=0$ and $\beta$ at
$t=T$, what the probability that the system undergoes the transition
$i \rightarrow j$ exactly $N$ times.

To treat this problem, we will follow in the footsteps of Gopich and
Szabo\cite{Gopich2003}, introducing a dummy factor $\lambda$ into
transition element $K_{ij}$ to form the new transition matrix $K^*$.
We then proceed in finding a propagator $\mathbf{\hat F}$ for this new
system. We can then evaluate $\mathbf{\hat F}_{\beta\alpha}$,
expanding in powers of $\lambda$. This will produce a series of terms
of the form $\sum_N \lambda^N P_{\beta\alpha}(N, s)$, which will serve
to answer our original query.

The propagator of our modified kinetic scheme $\mathbf{K}^*$ is easily
found by the considering the decomposition,
\[ \mathbf{K}^* = (\mathbf{K} - \mathbf{V}) + \lambda \mathbf{V} \]
where $\mathbf V$ is defined with a single non-zero element, $V_{ji} =
k_{ji}$. 
We can then derive a propagator for these pieces
individually, exploiting the linearity of first-order kinetics.
This results in the propagator,
\[ \mathbf{\hat G}^*(\lambda, s) = \left(s \mathbf{1} - (\mathbf{K} - \mathbf{V}) - \lambda \mathbf{V} \right)^{-1} \]

Moreover, we note that by making $\lambda$ vanish, we preclude the $i
\rightarrow j$ transition entirely. Intuitively, we should
be able to relate $\mathbf{\hat G}(0, s)^*$ to our original original
propagator $\mathbf{\hat G}(s)$ with the $i \rightarrow j$ transition
removed. Specifically, it can be shown that,\todo{Show}
\[ \hat G^*_{\beta\alpha}(0, s) = \hat G_{\beta\alpha}(s) -
\frac{\hat G_{\beta j}(s) K_{ji} \hat G_{i\alpha}(s)}{1 + K_{ji} \hat G_{ij}(s)}
\]

Expanding in powers of $\lambda$, we find a series,
\[ \mathbf{\hat G}^*(\lambda, s) = \mathbf{\hat G'}
  + \lambda \mathbf{\hat G'} \mathbf{V} \mathbf{\hat G'}
  + \lambda \mathbf{\hat G'} \mathbf{V} \mathbf{\hat G'} \mathbf{V} \mathbf{\hat G'}
  + ...
\]
where we have defined $\mathbf{\hat G'}(s) = \mathbf{\hat G}(0, s)$.
This gives our final result,
\[ \hat P_{\beta\alpha}(N,s) = K_{ji}^N \hat G'_{\beta j}(s) \hat G_{ij}^{N-1} \hat G'_{i\alpha}(s) \]
for $N \ge 1$ and $\hat P_{\beta\alpha}(N,s) = \hat
G'_{\beta\alpha}(s)$ for $N=0$. Furthermore, it can be shown that $\mathrm{\hat G^*}$ is the generating function of this count distribution $\hat P(N,s)$. That is the $n$th moment of this
distribution is given by,
\[ \frac{d^n}{d^n \lambda} \mathrm{\hat G^*}(s, \lambda) \]
evaluated at $\lambda = 0$.

With this formalism in hand, we can easily approach a number of common
questions in a single-molecule analysis.

\end{document}